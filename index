<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>6 Green Newsletter</title>
    <style>
        :root {
            --primary-color: #4CAF50;
            --primary-dark: #45a049;
            --text-color: #333;
            --bg-color: #f0f0f0;
        }
        * { box-sizing: border-box; }
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen-Sans, Ubuntu, Cantarell, 'Helvetica Neue', sans-serif; 
            line-height: 1.6; 
            margin: 0; 
            padding: 0; 
            color: var(--text-color); 
            background-color: var(--bg-color);
        }
        .container { 
            max-width: 800px; 
            margin: 0 auto; 
            padding: 20px; 
            background-color: white; 
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        header { 
            background: var(--primary-color); 
            padding: 20px 0; 
            color: white;
        }
        h1 { text-align: center; margin: 0; }
        nav { 
            display: flex; 
            justify-content: center; 
            flex-wrap: wrap; 
            gap: 10px; 
            margin-top: 20px;
        }
        nav button { 
            background: var(--primary-dark); 
            color: white; 
            border: none; 
            padding: 10px 15px; 
            cursor: pointer; 
            transition: background 0.3s; 
            font-size: 16px;
        }
        nav button:hover, nav button:focus { 
            background: #357a38; 
            outline: none;
        }
        #newsletter-content { 
            margin-top: 20px; 
            text-align: center;
        }
        #newsletter-content a { 
            display: inline-block; 
            margin-top: 10px; 
            padding: 10px 20px; 
            background-color: var(--primary-color); 
            color: white; 
            text-decoration: none; 
            border-radius: 5px;
            transition: background-color 0.3s;
        }
        #newsletter-content a:hover, #newsletter-content a:focus { 
            background-color: var(--primary-dark);
            outline: none;
        }
        #links-section { margin-top: 20px; }
        #links-section a { 
            color: var(--primary-color); 
            text-decoration: none;
            transition: color 0.3s;
        }
        #links-section a:hover, #links-section a:focus { 
            text-decoration: underline; 
            color: var(--primary-dark);
        }
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border-width: 0;
        }
        @media (max-width: 600px) {
            nav button {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <header>
        <h1>6 Green Newsletter</h1>
        <nav id="newsletter-nav" aria-label="Newsletter navigation"></nav>
    </header>
    <main class="container">
        <div id="newsletter-content" aria-live="polite"></div>
        <div id="links-section" aria-live="polite"></div>
    </main>

    <script>
    (function() {
        'use strict';

        const CANVA_URL = 'https://www.canva.com/design/DAGN_OghJQo/k5ifeZXWfik0FME79_JxLw/view?utm_content=DAGN_OghJQo&utm_campaign=designshare&utm_medium=link&utm_source=editor';
        let newsletters = [];

        function fetchNewsletters() {
            const today = new Date();
            for (let i = 0; i < 10; i++) {
                const date = new Date(today.getFullYear(), today.getMonth(), today.getDate() - (i * 7));
                if (date.getDay() === 5) { // Friday
                    newsletters.push({
                        id: date.toISOString().split('T')[0],
                        title: date.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' }),
                        content: `<p>Newsletter for ${date.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}</p><a href="${CANVA_URL}" target="_blank" rel="noopener noreferrer">View Newsletter<span class="sr-only"> for ${date.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}</span></a>`,
                        links: [
                            { text: 'School Calendar', url: '#calendar' },
                            { text: 'Lunch Menu', url: '#lunch' },
                            { text: 'Parent Portal', url: '#portal' }
                        ]
                    });
                }
            }
        }

        function populateNavigation() {
            const nav = document.getElementById('newsletter-nav');
            newsletters.forEach(newsletter => {
                const button = document.createElement('button');
                button.textContent = newsletter.title;
                button.setAttribute('data-id', newsletter.id);
                button.addEventListener('click', function() {
                    displayNewsletter(this.getAttribute('data-id'));
                });
                nav.appendChild(button);
            });
        }

        function displayNewsletter(id) {
            const newsletter = newsletters.find(n => n.id === id);
            if (newsletter) {
                document.getElementById('newsletter-content').innerHTML = newsletter.content;
                const linksList = document.getElementById('links-section');
                linksList.innerHTML = '<h2>Quick Links</h2><ul></ul>';
                const ul = linksList.querySelector('ul');
                newsletter.links.forEach(link => {
                    const li = document.createElement('li');
                    const a = document.createElement('a');
                    a.href = link.url;
                    a.textContent = link.text;
                    a.setAttribute('target', '_blank');
                    a.setAttribute('rel', 'noopener noreferrer');
                    li.appendChild(a);
                    ul.appendChild(li);
                });
                trackView(id);
            }
        }

        function trackView(id) {
            // In a real scenario, this would send data to an analytics service
            console.log(`Newsletter viewed: ${id}`);
        }

        function trackClick(linkText) {
            // In a real scenario, this would send data to an analytics service
            console.log(`Link clicked: ${linkText}`);
        }

        function init() {
            fetchNewsletters();
            populateNavigation();

            document.getElementById('links-section').addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    trackClick(e.target.textContent);
                }
            });

            // Display the most recent newsletter by default
            if (newsletters.length > 0) {
                displayNewsletter(newsletters[0].id);
            }
        }

        // Ensure the DOM is fully loaded before initializing
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', init);
        } else {
            init();
        }
    })();
    </script>
</body>
</html>
